{% extends "common/base.html" %}
{% block page_title %}Edit Profile{% endblock %}

{% block content %}
<div class="row g-3">
    <div class="col-lg-7">
        <div class="card shadow-sm">
            <div class="card-body">
                <h4 class="mb-2">Edit Profile</h4>
                <p class="text-muted mb-4">Update your preferred name and avatar. These changes reflect instantly in the workspace.</p>
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label class="form-label">{{ form.first_name.label }}</label>
                        {{ form.first_name }}
                        {% if form.first_name.errors %}
                            <div class="text-danger small">{{ form.first_name.errors|first }}</div>
                        {% endif %}
                    </div>
                    <div class="mb-3">
                        <label class="form-label">{{ form.last_name.label }}</label>
                        {{ form.last_name }}
                        {% if form.last_name.errors %}
                            <div class="text-danger small">{{ form.last_name.errors|first }}</div>
                        {% endif %}
                    </div>
                    <div class="mb-3">
                        <label class="form-label">{{ form.profile_picture.label }}</label>
                        {{ form.profile_picture }}
                        <div class="form-text">JPEG, PNG or WebP up to 5MB.</div>
                        {% if form.profile_picture.errors %}
                            <div class="text-danger small">{{ form.profile_picture.errors|first }}</div>
                        {% endif %}
                    </div>
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                        <a class="btn btn-outline-secondary" href="{% url 'marketing:global_home' %}">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="col-lg-5">
        <div class="card shadow-sm h-100">
            <div class="card-body d-flex flex-column justify-content-center text-center">
                <div class="mb-3">
                    {% if user.profile_picture %}
                        <img src="{{ user.profile_picture.url }}" class="rounded-circle border border-3 border-light shadow" style="width:140px; height:140px; object-fit:cover;" alt="Current avatar">
                    {% else %}
                        <div class="rounded-circle bg-gradient shadow d-inline-flex align-items-center justify-content-center text-white fw-semibold" style="width:140px; height:140px; background:linear-gradient(135deg,#7c3aed,#d946ef); font-size:2.5rem;">
                            {{ user.get_full_name|default:user.email|slice:":2"|upper }}
                        </div>
                    {% endif %}
                </div>
                <h5 class="mb-0">{{ user.get_full_name|default:user.email }}</h5>
                <div class="text-muted">{{ user.email }}</div>
                <p class="small text-muted mt-2 mb-0">Need more changes? Contact the Super Admin for full profile edits.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
